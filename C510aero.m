function FM = C510aero(alpha, beta, Mach, De,Da,Dr, p,q,r, adot)
%% inputs:
%  alpha, beta  - rad
%  Mach         - undim
%  De,Da,Dr     - deg
%  p,q,r        - undim
%  adot         - undim

% % Elevator limits
% de_min = -28;
% de_max =  23;
% 
% % Aileron limits
% da_min = -20;
% da_max =  15;
% 
% % Rudder limits
% dr_min = -16;
% dr_max =  16;

AlphaTable = [-10    -8    -6    -4    -2     0     2     4     6     8    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    30    35    40    45    50    55    60    65    70    75    80    85    90];
AlphaTabe_rad = deg2rad(AlphaTable);

%% Drag force
% Drag_at_zero_lift
CD0 = 0;

% Drag_due_to_alpha
CDTable = [ 0.0814    0.0613    0.0458    0.0347    0.0280    0.0258    0.0280    0.0347    0.0458    0.0613    0.0705    0.0811    0.0933    0.1073    0.1180    0.1298    0.1428    0.1571    0.1728    0.1901    0.2091    0.2300    0.2530    0.2783  0.3061    0.3392    0.5617    0.8479    1.1934    1.5886    2.0199    2.4698    2.9185    3.3450    3.7284    4.0495    4.2916    4.4422    4.4933];
CDStatic = interp1(AlphaTabe_rad, CDTable, alpha);

% Drag_due_to_Elevator_Deflection, per rad
CDDe = 0.07;

% Drag_due_to_sideslip
CDbeta = 0.16;

CD = CD0 + CDStatic + CDDe*deg2rad(De) + CDbeta*abs(beta);



%% Side force
% Side_force_due_to_beta
CYBetaTable = [-0.6489   -0.6525   -0.6553   -0.6573   -0.6585   -0.6589   -0.6585   -0.6573   -0.6553   -0.6525   -0.6489   -0.6468   -0.6445   -0.6420   -0.6393   -0.6364   -0.6334   -0.6301   -0.6266   -0.6230   -0.6191   -0.6151   -0.6109   -0.6065 -0.6019   -0.5971   -0.5706   -0.5397   -0.5047   -0.4659   -0.4235   -0.3779   -0.3294   -0.2785   -0.2254   -0.1705   -0.1144   -0.0574    0.0000];
CYb = interp1(AlphaTabe_rad,CYBetaTable,alpha);
% Side_force_due_to_aileron
CYDa = -0.043;

% Side_force_due_to_rudder
CYDr = 0.1574;

% Side_force_due_to_roll_rate
CYp = -0.04;

% Side_force_due_to_yaw_rate
CYr = 0.233;

CY = CYb*beta + CYDa*deg2rad(Da) + CYDr*deg2rad(Dr) + CYp*p + CYr*r;

%% Lift(alpha, De, adot, q)
% Lift_due_to_alpha
CLTable = [-1.1041   -0.8833   -0.6625   -0.4417   -0.2208   0    0.2208    0.4417    0.6625    0.8833    1.1041    1.2117    1.2885    1.3346    1.3500    1.3346    1.2885    1.2117    1.1041    0.9659    0.7968    0.7300    0.7300    0.7400    0.7600    0.7800    0.9728    1.2109    1.4222    1.5886    1.6949    1.7294    1.6850    1.5598    1.3570    1.0850    0.7567    0.3886   -0.0000];
CLStatic = interp1(AlphaTabe_rad,CLTable,alpha);
% Lift_due_to_Elevator_Deflection
CLDeTable = [0.4885    0.4912    0.4933    0.4948    0.4957    0.4956    0.4951    0.4937    0.4915    0.4882    0.4835    0.4805    0.4769    0.4727    0.4677    0.4619    0.4550    0.4468    0.4373    0.4263    0.4136    0.3994    0.3837    0.3667    0.3488    0.3306    0.2505    0.2058    0.1827    0.1660    0.1503    0.1339    0.1167    0.0987    0.0798    0.0604    0.0405    0.0203   -0.0000];
CLDe = interp1(AlphaTabe_rad,CLDeTable,alpha);

% Lift_due_to_alpha_rate
CLadot = 2.24;

% Lift_due_to_pitch_rate
CLq  = 4.49;

CL = CLStatic + CLDe*deg2rad(De) + CLadot*adot + CLq*q;


%% Roll
% Roll_moment_due_to_beta
ClBetaTable = [0.0027   -0.0068   -0.0164   -0.0261   -0.0358   -0.0454   -0.0550   -0.0646   -0.0740   -0.0832   -0.0922   -0.0965   -0.0995   -0.1011   -0.1013   -0.1002   -0.0978   -0.0940   -0.0891   -0.0828   -0.0754   -0.0722   -0.0717   -0.0716  -0.0718   -0.0720   -0.0761   -0.0805   -0.0824   -0.0812   -0.0768   -0.0694   -0.0595   -0.0480   -0.0358   -0.0240   -0.0136   -0.0054    0.0000];
Clb = interp1(AlphaTabe_rad,ClBetaTable,alpha);

% Roll_moment_due_to_roll_rate_(roll_damping)
ClpTable = [-0.7476   -0.7517   -0.7549   -0.7572   -0.7586   -0.7591   -0.7586   -0.7572   -0.7549   -0.7517   -0.7476   -0.7452   -0.7425   -0.7396   -0.7365   -0.7332   -0.7297   -0.7259   -0.7219   -0.7177   -0.7133   -0.7087   -0.7038   -0.6988    -0.6935   -0.6880   -0.6574   -0.6218   -0.5815   -0.5368   -0.4879   -0.4354   -0.3795   -0.3208   -0.2596   -0.1965   -0.1318   -0.0662    0.0000];
Clp = interp1(AlphaTabe_rad,ClpTable,alpha);

% Roll_moment_due_to_yaw_rate
ClrTable = [-0.7476   -0.7517   -0.7549   -0.7572   -0.7586   -0.7591   -0.7586   -0.7572   -0.7549   -0.7517   -0.7476   -0.7452   -0.7425   -0.7396   -0.7365   -0.7332   -0.7297   -0.7259   -0.7219   -0.7177   -0.7133   -0.7087   -0.7038   -0.6988    -0.6935   -0.6880   -0.6574   -0.6218   -0.5815   -0.5368   -0.4879   -0.4354   -0.3795   -0.3208   -0.2596   -0.1965   -0.1318   -0.0662    0.0000];
Clr = interp1(AlphaTabe_rad,ClrTable,alpha);

% Roll_moment_due_to_aileron
ClDaTable   = [0.1099    0.1105    0.1110    0.1113    0.1115    0.1116    0.1115    0.1113    0.1110    0.1105    0.1099    0.1095    0.1091    0.1087    0.1083    0.1078    0.1073    0.1067    0.1061    0.1055    0.1048    0.1042    0.1035    0.1027    0.1019    0.1011    0.0966    0.0914    0.0855    0.0789    0.0717    0.0640    0.0558    0.0472    0.0382    0.0289    0.0194    0.0097   -0.0000];
ClDa = interp1(AlphaTabe_rad,ClDaTable,alpha);

% Roll_moment_due_to_rudder
ClDrTable   = [-0.0383   -0.0385   -0.0386   -0.0388   -0.0388   -0.0389   -0.0388   -0.0388   -0.0386   -0.0385   -0.0383   -0.0381   -0.0380   -0.0379   -0.0377   -0.0375   -0.0374   -0.0372   -0.0370   -0.0367   -0.0365   -0.0363   -0.0360   -0.0358    -0.0355   -0.0352   -0.0337   -0.0318   -0.0298   -0.0275   -0.0250   -0.0223   -0.0194   -0.0164   -0.0133   -0.0101   -0.0067   -0.0034    0.0000];
ClDr = interp1(AlphaTabe_rad,ClDrTable,alpha);
 
Cl = Clb*beta + ClDa*deg2rad(Da) + ClDr*deg2rad(Dr) + Clp*p + Clr*r;



%% Pitch moment (alpha, q, adot, De)
% Pitch_moment_due_to_alpha
CmTable = [0.1467    0.1176    0.0884    0.0590    0.0295         0   -0.0295   -0.0590   -0.0884   -0.1176   -0.1464   -0.1605   -0.1704   -0.1764   -0.1782   -0.1761   -0.1702   -0.1604   -0.1469   -0.1299   -0.1092   -0.0983   -0.0885   -0.0796          -0.0717   -0.0755   -0.1223   -0.1940   -0.2537   -0.3070   -0.3603   -0.4120   -0.4605   -0.5043   -0.5421   -0.5728   -0.5954   -0.6093   -0.6139];
CmStatic = interp1(AlphaTabe_rad,CmTable,alpha);

% Pitch_moment_due_to_pitch_rate
Cmq = -13.17;

% Pitch_moment_due_to_alpha_rate
Cmadot = -7.42;

% Pitching_moment_at_zero_alpha
Cmo = 0.02;

% Pitch_moment_due_to_elevator_deflection
CmDeTable = [-1.5323   -1.5408   -1.5474   -1.5521   -1.5549   -1.5547   -1.5530   -1.5488   -1.5417   -1.5313   -1.5166   -1.5071   -1.4960   -1.4828   -1.4672   -1.4488   -1.4271   -1.4015   -1.3717   -1.3371   -1.2975   -1.2528   -1.2034   -1.1501   -1.0941   -1.0369   -0.7858   -0.6456   -0.5731   -0.5208   -0.4714   -0.4201   -0.3661   -0.3094   -0.2504   -0.1895   -0.1271   -0.0638    0.0000];
CmDe = interp1(AlphaTabe_rad,CmDeTable,alpha);

Cm = Cmo + CmStatic + Cmq*q + Cmadot*adot + CmDe*deg2rad(De);



%% Yaw moment
% Yaw_moment_due_to_beta
CnBetaTable = [0.0945    0.0959    0.0972    0.0983    0.0994    0.1003    0.1011    0.1018    0.1023    0.1028    0.1030    0.1031    0.1031    0.1028    0.1025    0.1019    0.1013    0.1005    0.0995    0.0984    0.0972    0.0963    0.0957    0.0950    0.0944    0.0937    0.0902    0.0861    0.0811    0.0753    0.0687    0.0614    0.0535    0.0450    0.0361    0.0271    0.0179    0.0089   -0.0000];
Cnb = interp1(AlphaTabe_rad,CnBetaTable,alpha);

% Yaw_moment_due_to_roll_rate
CnpTable = [0.1536    0.1236    0.0931    0.0623    0.0312         0   -0.0312   -0.0623   -0.0931   -0.1236   -0.1536   -0.1681   -0.1781   -0.1838   -0.1851   -0.1822   -0.1750   -0.1637   -0.1484   -0.1290   -0.1058   -0.0963   -0.0956   -0.0963   -0.0981   -0.0999   -0.1190   -0.1402   -0.1539   -0.1587   -0.1539   -0.1402   -0.1190   -0.0931   -0.0656   -0.0397   -0.0186   -0.0048   -0.0000];
Cnp = interp1(AlphaTabe_rad,CnpTable,alpha);

% Yaw_moment_due_to_yaw_rate
CnrTable = [-0.1883   -0.1445   -0.1102   -0.0855   -0.0706   -0.0656   -0.0706   -0.0855   -0.1102   -0.1445   -0.1883   -0.2128   -0.2314   -0.2427   -0.2458   -0.2406   -0.2274   -0.2074   -0.1818   -0.1529   -0.1231   -0.1125   -0.1117   -0.1123    -0.1143   -0.1162   -0.1412   -0.1775   -0.2098   -0.2302   -0.2324   -0.2143   -0.1790   -0.1336   -0.0873   -0.0484   -0.0216   -0.0071    0.0000];
Cnr = interp1(AlphaTabe_rad,CnrTable,alpha);

% Yaw_moment_due_to_aileron
CnDaTable   = [0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0];
CnDa = interp1(AlphaTabe_rad,CnDaTable,alpha);

% Yaw_moment_due_to_rudder
CnDrTable   = [-0.0917   -0.0922   -0.0926   -0.0929   -0.0931   -0.0931   -0.0931   -0.0929   -0.0926   -0.0922   -0.0917   -0.0914   -0.0911   -0.0907   -0.0904   -0.0900   -0.0895   -0.0891   -0.0886   -0.0881   -0.0875   -0.0869   -0.0863   -0.0857    -0.0851   -0.0844   -0.0807   -0.0763   -0.0713   -0.0659   -0.0599   -0.0534   -0.0466   -0.0394   -0.0319   -0.0241   -0.0162   -0.0081    0.0000];
CnDr = interp1(AlphaTabe_rad,CnDrTable,alpha);

Cn  = Cnb*beta + Cnp*p + Cnr*r + CnDa*deg2rad(Da) + CnDr*deg2rad(Dr);




%% In wind axes
FM = [CD CY CL Cl Cm Cn]';
CF = [CD CY CL]';
CM = [Cl Cm Cn]';

end













